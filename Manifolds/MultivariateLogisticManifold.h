#ifndef _MultivariateLogisticManifold_h
#define _MultivariateLogisticManifold_h


#include <memory>
#include <GaussianRandomVariable.h>
#include "AbstractManifold.h"

class MultivariateLogisticManifold : public AbstractManifold {
public:

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // typedef :
    ////////////////////////////////////////////////////////////////////////////////////////////////////

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Constructor(s) / Destructor :
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    MultivariateLogisticManifold();


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Getter(s) and Setter(s) :
    ////////////////////////////////////////////////////////////////////////////////////////////////////

    // Get the number of independent components Ns
    inline int GetNumberOfIndependentComponents() const { return m_NumberOfIndependentComponents; }

    // Set the propagation coefficient
    void SetPropagationCoefficient(std::vector< std::shared_ptr< GaussianRandomVariable> > PropagationCoefficient);


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Other method(s) :
    ////////////////////////////////////////////////////////////////////////////////////////////////////

    // Compute parallel Curve
    std::vector<double> ComputeParallelCurve(double P0, double T0, double V0, std::vector<double> W0, double T);


protected:

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Attribute(s) :
    ////////////////////////////////////////////////////////////////////////////////////////////////////

    // Number of Ns statistically independent components
    int m_NumberOfIndependentComponents;

    // Pointer to the propagation coefficient
    std::vector< std::shared_ptr< GaussianRandomVariable >> m_PropagationCoefficient;


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Other method(s) :
    ////////////////////////////////////////////////////////////////////////////////////////////////////

    // Compute geodesic
    double ComputeGeodesic(double P0, double T0, double V0, double T);

    // Compute Geodesic Derivative
    double ComputeGeodesicDerivative(double P0, double T0, double V0, double T);

    // Compute parallel transport of vector W0
    std::vector<double> ComputeParallelTransport(double P0, double T0, double V0, std::vector<double> W0, double T) ;

};


#endif //_MultivariateLogisticManifold_h
